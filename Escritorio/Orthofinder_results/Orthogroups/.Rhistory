#TOMATO
density_plot_tomato <- ggplot(tomato_density, aes(x=value, color=Stage)) +
geom_density( size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("B")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "none", axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17),
legend.text = element_text(size=17),
axis.text.y = element_text(size = 17),
axis.text.x = element_text(size = 17))
dim(tomato_density)
library("gridExtra")
my_comparisons <- list( c("MG", "B"), c("S2", "MG"),
c("S1", "S2"), c("S1","B"),c("S1", "MG") )
violin_plot_pepper <- ggplot(pepper_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none", axis.ticks.x=element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 17),
axis.text.y = element_text(size = 17)) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
# scale_y_continuous(breaks = seq(0, 25000, 5000)) +
labs(y="Log2 RPKM", x= " ", tag = c("B")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size=4.3) # Add pairwise comparisons p-value+
violin_plot_tomato <- ggplot(tomato_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_text(size = 17),
axis.text.y = element_text(size = 17)) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
#scale_y_continuous(breaks = seq(0, 25, 5)) +
labs(y="Log2 RPKM", x=" ", tag = c("D")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size = 4.3) # Add pairwise comparisons p-value+
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
# pdf(file= "/home/alejandra/Escritorio/resultados/Plots/Imagenes/expression_orthologous.pdf" , paper='A4r',  width = 0, height = 0)
violin_plot_tomato <- ggplot(tomato_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none")+
theme_grey(base_size = 16)
violin_plot_tomato <- ggplot(tomato_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none")+
theme_grey(base_size = 16) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
#scale_y_continuous(breaks = seq(0, 25, 5)) +
labs(y="Log2 RPKM", x=" ", tag = c("D")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size = 4.3) # Add pairwise comparisons p-value+
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
violin_plot_tomato <- ggplot(tomato_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x =element_blank()) +
theme_grey(base_size = 17)
violin_plot_tomato <- ggplot(tomato_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x =element_blank()) +
theme_grey(base_size = 17) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
#scale_y_continuous(breaks = seq(0, 25, 5)) +
labs(y="Log2 RPKM", x=" ", tag = c("D")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size = 4.3) # Add pairwise comparisons p-value+
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
violin_plot_pepper <- ggplot(pepper_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none", axis.ticks.x=element_blank(),
axis.text.x = element_blank()) +
theme_grey(base_size = 17) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
# scale_y_continuous(breaks = seq(0, 25000, 5000)) +
labs(y="Log2 RPKM", x= " ", tag = c("B")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size=4.3) # Add pairwise comparisons p-value+
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
theme(legend.position = "none", axis.ticks.x=element_blank(),
axis.text.x = element_blank()) +
violin_plot_pepper <- ggplot(pepper_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
#  theme(legend.position = "none", axis.ticks.x=element_blank(),
#       axis.text.x = element_blank()) +
theme_grey(base_size = 17, legend.position = "none", axis.ticks.x=element_blank(),
axis.text.x = element_blank()) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
# scale_y_continuous(breaks = seq(0, 25000, 5000)) +
labs(y="Log2 RPKM", x= " ", tag = c("B")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size=4.3) # Add pairwise comparisons p-value+
violin_plot_tomato <- ggplot(tomato_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x =element_blank()) +
theme_grey(base_size = 17) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
#scale_y_continuous(breaks = seq(0, 25, 5)) +
labs(y="Log2 RPKM", x=" ", tag = c("D")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size = 4.3) # Add pairwise comparisons p-value+
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
violin_plot_pepper <- ggplot(pepper_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none", axis.ticks.x=element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 17),
axis.text.y = element_text(size = 17)) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
# scale_y_continuous(breaks = seq(0, 25000, 5000)) +
labs(y="Log2 RPKM", x= " ", tag = c("B")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size=4.3) # Add pairwise comparisons p-value+
violin_plot_tomato <- ggplot(tomato_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_text(size = 17),
axis.text.y = element_text(size = 17)) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
#scale_y_continuous(breaks = seq(0, 25, 5)) +
labs(y="Log2 RPKM", x=" ", tag = c("D")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size = 4.3) # Add pairwise comparisons p-value+
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
#Density plots with semi-transparent fill (FILTER DATA)
#PEPPER
density_plot_pepper <- ggplot(pepper_density, aes(x=value, color=Stage)) +
geom_density(size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("A")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "none", axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17),
axis.text.y = element_text(size = 17),
axis.text.x = element_text(size = 17),
text = element_text(17))
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
#Density plots with semi-transparent fill (FILTER DATA)
#PEPPER
density_plot_pepper <- ggplot(pepper_density, aes(x=value, color=Stage)) +
geom_density(size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("A")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "none", axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17),
axis.text.y = element_text(size = 17),
axis.text.x = element_text(size = 17),
strip.text = element_text(size = 17))
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
#Density plots with semi-transparent fill (FILTER DATA)
#PEPPER
density_plot_pepper <- ggplot(pepper_density, aes(x=value, color=Stage)) +
geom_density(size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("A")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "none", axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17),
axis.text.y = element_text(size = 17),
axis.text.x = element_text(size = 17))
#TOMATO
density_plot_tomato <- ggplot(tomato_density, aes(x=value, color=Stage)) +
geom_density( size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("B")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "none", axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17),
legend.text = element_text(size=17),
axis.text.y = element_text(size = 17),
axis.text.x = element_text(size = 17),
)
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
#Density plots with semi-transparent fill (FILTER DATA)
#PEPPER
density_plot_pepper <- ggplot(pepper_density, aes(x=value, color=Stage)) +
geom_density(size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("A")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "none", axis.title.x = element_text(size = 18),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 18))
dim(pepper_density)
#TOMATO
density_plot_tomato <- ggplot(tomato_density, aes(x=value, color=Stage)) +
geom_density( size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("B")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "none", axis.title.x = element_text(size = 18),
axis.title.y = element_text(size = 18),
legend.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 18),
)
dim(tomato_density)
library("gridExtra")
#legend <- get_legend(density_plot_tomato)
my_comparisons <- list( c("MG", "B"), c("S2", "MG"),
c("S1", "S2"), c("S1","B"),c("S1", "MG") )
violin_plot_pepper <- ggplot(pepper_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none", axis.ticks.x=element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size = 18)) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
# scale_y_continuous(breaks = seq(0, 25000, 5000)) +
labs(y="Log2 RPKM", x= " ", tag = c("B")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size=4.3) # Add pairwise comparisons p-value+
violin_plot_tomato <- ggplot(tomato_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size = 18)) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
#scale_y_continuous(breaks = seq(0, 25, 5)) +
labs(y="Log2 RPKM", x=" ", tag = c("D")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size = 4.3) # Add pairwise comparisons p-value+
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
# pdf(file= "/home/alejandra/Escritorio/resultados/Plots/Imagenes/expression_orthologous.pdf" , paper='A4r',  width = 0, height = 0)
#   ggarrange(density_plot_pepper, violin_plot_pepper, ncol = 2, widths = c(1, 0.5), labels = c("A", "B"))
#   ggarrange(density_plot_tomato, violin_plot_tomato, ncol = 2, widths = c(1, 0.5), labels = c("A", "B"))
# dev.off()
library(dplyr)
library(tidyverse)
library(ggpubr)
#::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::.
pepper_count <- read.table("/home/alejandra/Escritorio/resultados/counting_reads/pepper.v2_counts.txt", header=T)
tomato_count <- read.table("/home/alejandra/Escritorio/resultados/counting_reads/m82_tomato_counts.txt", header=T)
pepper_count <- pepper_count %>% dplyr::select(Geneid, cm334_PRB.1.sorted.bam:cm334_PRS2.3.sorted.bam)
colnames(pepper_count) <- gsub(".sorted.bam","", colnames(pepper_count))
colnames(pepper_count) <- gsub("\\.","_", colnames(pepper_count))
pepper_count <- pepper_count[,-c(13)]
tomato_count <- tomato_count %>% dplyr::select(Geneid,
m82_PRB_1_1.sorted.bam:m82_PRB_3_1.sorted.bam,
-m82_PRB3_1_1.sorted.bam,
m82_PRMG_1_1.sorted.bam:m82_PRS2_3_1.sorted.bam)
colnames(tomato_count) <- gsub(".sorted.bam","", colnames(tomato_count))
colnames(tomato_count)[2:13] <- gsub(".{2}$","", colnames(tomato_count)[2:13])
#tomato_count <- tomato_count[,-c(4)]
head(tomato_count)
head(pepper_count)
#colnames(tomato_count) <- gsub("_1.sorted.bam","", colnames(tomato_count))
pepper_count<- pepper_count %>% dplyr::rename(pepper.faa=Geneid)
tomato_count<- tomato_count %>% dplyr::rename(lycopersicum.faa=Geneid)
tomato_count$lycopersicum.faa<- gsub("gene:","",tomato_count$lycopersicum.faa)
dim(pepper_count) #35845
dim(tomato_count) #34075
#Nombre de los genes y las proteinas para la anotacion de chile
pepper_id <- read.table("/home/alejandra/Escritorio/resultados/orthologous/list2.txt")
colnames(pepper_id) <- c("protein.faa","pepper.faa")
head(pepper_id)
pepper_count <- merge(pepper_count, pepper_id, by = "pepper.faa")
pepper_count <- pepper_count %>% dplyr::rename(pepper.faa=protein.faa, pepper.gene=pepper.faa)
head(pepper_count)
#::::::::::::::::::::::::
#NORMALIZATION
#LENGTH MATRIX
pepper_length <- read_tsv("/home/alejandra/Escritorio/resultados/Plots/Imagenes/count_matrix/pepper_length.tsv", col_names=T)
tomato_length <- read_tsv("/home/alejandra/Escritorio/resultados/Plots/Imagenes/count_matrix/tomato_length.tsv", col_names=T) %>%
dplyr::mutate(Geneid=(gsub("gene:", "", Geneid))) %>%
dplyr::rename(lycopersicum.faa=Geneid)
head(pepper_length)
head(tomato_length)
pepper_count<-
merge(pepper_count, pepper_length, by = "pepper.gene") %>%
dplyr::select(-pepper.faa) %>%
column_to_rownames("pepper.gene")
tomato_count<-
merge(tomato_count, tomato_length, by = "lycopersicum.faa") %>%
column_to_rownames("lycopersicum.faa")
#CALCULAR RPKM COUNTS
head(pepper_count)
dge <- DGEList(pepper_count %>% dplyr::select(-Length))
dge <- calcNormFactors(dge, method="TMM")
pepper_count_rpkm <- rpkm(dge,gene.length = pepper_count$Length, log=FALSE)
head(tomato_count)
dge <- DGEList(tomato_count %>% dplyr::select(-Length))
dge <- calcNormFactors(dge, method="TMM")
tomato_count_rpkm <- rpkm(dge,gene.length = tomato_count$Length, log=FALSE)
pepper_count_rpkm_avr=data.frame(apply(array(as.matrix(pepper_count_rpkm), c(nrow(pepper_count_rpkm),3, ncol(pepper_count_rpkm)/3)),3, rowMeans))
colnames(pepper_count_rpkm_avr) <- c("B", "MG","S1","S2")
rownames(pepper_count_rpkm_avr) <- rownames(pepper_count_rpkm)
dim(pepper_count_rpkm_avr)
head(pepper_count_rpkm_avr)
tomato_count_rpkm_avr=data.frame(apply(array(as.matrix(tomato_count_rpkm), c(nrow(tomato_count_rpkm),3, ncol(tomato_count_rpkm)/3)),3, rowMeans))
colnames(tomato_count_rpkm_avr) <- c("B", "MG","S1","S2")
rownames(tomato_count_rpkm_avr) <- rownames(tomato_count_rpkm)
dim(tomato_count_rpkm_avr)
head(tomato_count_rpkm_avr)
pepper_count_rpkm_avr <- pepper_count_rpkm_avr[rowSums(pepper_count_rpkm_avr) > 0, ]
tomato_count_rpkm_avr <- tomato_count_rpkm_avr[rowSums(tomato_count_rpkm_avr) > 0, ]
dim(pepper_count_rpkm_avr) #24224
dim(tomato_count_rpkm_avr) #26964
log2_pepper <- log2(pepper_count_rpkm_avr + 1)
log2_tomato <- log2(tomato_count_rpkm_avr + 1)
#Exploring raw data
pepper_density <- gather(as.data.frame(log2_pepper)) %>%
filter(value > 1)
head(pepper_density)
tomato_density <- gather(as.data.frame(log2_tomato)) %>%
filter(value > 1)
pepper_density$key <- factor(pepper_density$key,
levels = c("S1", "S2", "MG","B"))
tomato_density$key <- factor(tomato_density$key,
levels = c("S1", "S2", "MG","B"))
pepper_density <- pepper_density %>% dplyr::rename(Stage=key)
tomato_density <- tomato_density %>% dplyr::rename(Stage=key)
#Density plots with semi-transparent fill (FILTER DATA)
#PEPPER
density_plot_pepper <- ggplot(pepper_density, aes(x=value, color=Stage)) +
geom_density(size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("A")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "none", axis.title.x = element_text(size = 18),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 18))
dim(pepper_density)
#TOMATO
density_plot_tomato <- ggplot(tomato_density, aes(x=value, color=Stage)) +
geom_density( size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("B")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "top", axis.title.x = element_text(size = 18),
axis.title.y = element_text(size = 18),
legend.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 18),
)
legend <- get_legend(density_plot_tomato)
#TOMATO
density_plot_tomato <- ggplot(tomato_density, aes(x=value, color=Stage)) +
geom_density( size=0.7) +
scale_color_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
labs(x="Log2 RPKM", y="Density", tag = c("B")) +
#  geom_vline(data=mu, aes(xintercept=grp.mean, color=key),
#            linetype="dashed")
theme(legend.position = "none", axis.title.x = element_text(size = 18),
axis.title.y = element_text(size = 18),
legend.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 18),
)
library("gridExtra")
my_comparisons <- list( c("MG", "B"), c("S2", "MG"),
c("S1", "S2"), c("S1","B"),c("S1", "MG") )
violin_plot_pepper <- ggplot(pepper_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none", axis.ticks.x=element_blank(),
axis.text.x = element_blank(),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size = 18)) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
# scale_y_continuous(breaks = seq(0, 25000, 5000)) +
labs(y="Log2 RPKM", x= " ", tag = c("B")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size=4.3) # Add pairwise comparisons p-value+
violin_plot_tomato <- ggplot(tomato_density, aes(x=Stage, y=value, fill=Stage)) +
geom_violin() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size = 18)) +
scale_fill_manual(values= c("#a32314","#c4922b","#308285","#929ea1")) +
geom_boxplot( width = 0.05, fill="white") +
#scale_y_continuous(breaks = seq(0, 25, 5)) +
labs(y="Log2 RPKM", x=" ", tag = c("D")) +
stat_compare_means(comparisons = my_comparisons, method = "t.test",
size = 4.3) # Add pairwise comparisons p-value+
grid.arrange(legend,
density_plot_pepper, violin_plot_pepper,
density_plot_tomato, violin_plot_tomato,
ncol=2, nrow=3, layout_matrix= rbind(c(1,1), c(2,3), c(4,5)),
heights = c(0.3, 3.5,3.5),
widths = c(2.7, 2))
library(dplyr)
library(tidyverse)
setwd("/home/alejandra/Escritorio/resultados/orthologous/orthofinder/pepper_v_tomato/Orthogroups/")
orthogroups <- read_tsv("Orthogroups.tsv", col_names = T)
library(dplyr)
library(tidyverse)
setwd("/home/alejandra/Escritorio/resultados/orthologous/orthofinder/pepper_v_tomato/Orthogroups/")
orthogroups <- read_tsv("Orthogroups.tsv", col_names = T)
head(orthogroups)
ortho_counts <- read_tsv("Orthogroups.GeneCount.tsv", col_names = T)
head(ortho_counts)
pepper_specific <-
ortho_counts %>%
dplyr::filter(lycopersicum == 0 & pepper >1)
nrow(pepper_specific) #806
tomato_specific <-
ortho_counts %>%
dplyr::filter(lycopersicum > 1 & pepper == 0 )
nrow(tomato_specific) #1005
colSums(pepper_specific[,-1]) #5461
colSums(tomato_specific[,-1]) #5088
setwd("/home/alejandra/Escritorio/resultados/orthologous/orthofinder/pepper_v_tomato/Orthogroups/")
orthogroups <- read_tsv("Orthogroups.tsv", col_names = T)
head(orthogroups)
ortho_counts <- read_tsv("Orthogroups.GeneCount.tsv", col_names = T)
head(ortho_counts)
one_to_many <-
ortho_counts %>%
dplyr::filter(lycopersicum == 1 & pepper >1)
nrow(one_to_many) #806
many_to_one <-
ortho_counts %>%
dplyr::filter(lycopersicum == 1 & pepper >1)
one_to_many <-
ortho_counts %>%
dplyr::filter(lycopersicum > 1 & pepper == 1 )
nrow(one_to_many) #1005
colSums(pepper_specific[,-1]) #5461
colSums(many_to_one[,-1]) #5461
colSums(one_to_many[,-1]) #
many_to_many <-
ortho_counts %>%
dplyr::filter(lycopersicum > 1 & pepper > 1 )
nrow(many_to_many)
colSums(many_to_many[,-1]) #4552 pepper to 1483 tomato
ortho_counts %>% dplyr::filter(lycopersicum == 1 & pepper == 1)
